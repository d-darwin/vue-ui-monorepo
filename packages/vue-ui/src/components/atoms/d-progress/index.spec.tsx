import { shallowMount } from "@vue/test-utils";
import {
  baseClassCase,
  controlIdAbsenceCase,
  controlIdAutogeneratedCase,
  controlIdPresenceCase,
  elementValueAttrCase,
  minControlWidthCase,
  offsetCase,
  propStringCase,
  propVNodeCase,
  roundingClassCase,
  slotCase,
} from "@/utils/test-case-factories";
import DProgress from "@/components/atoms/d-progress";
import config from "@/components/atoms/d-progress/config";
import { Type } from "@/components/atoms/d-progress/types";

describe("DProgress", () => {
  const wrapper = shallowMount(DProgress);

  baseClassCase(wrapper, config.className);

  controlIdAbsenceCase(wrapper, `.${config.progressClassName}`);
  controlIdPresenceCase(wrapper, `.${config.progressClassName}`);
  controlIdAutogeneratedCase(wrapper, `.${config.progressClassName}`);

  propStringCase(wrapper, `.${config.labelClassName}`, "label");
  propVNodeCase(wrapper, `.${config.labelClassName}`, "label");
  slotCase(DProgress, `.${config.labelClassName}`, "label");
  offsetCase(wrapper);
  // TODO: props.labelOptions

  elementValueAttrCase(wrapper, 34, `.${config.progressClassName}`);

  it("Should render linear variant if props.type === Type.linear", async () => {
    await wrapper.setProps({
      type: Type.linear,
      value: 99,
    });
    const progressEl = wrapper.find(`.${config.progressClassName}`);
    expect(progressEl.classes()).toContain(config.linearClassName);
  });

  it("Should render circular variant if props.type === Type.linear", async () => {
    await wrapper.setProps({
      type: Type.circular,
      value: 99,
    });
    const progressEl = wrapper.find(`.${config.progressClassName}`);
    expect(progressEl.classes()).toContain(config.circularClassName);
  });
  // TODO: props.progressOptions

  propStringCase(wrapper, `.${config.contentClassName}`, "content");
  propVNodeCase(wrapper, `.${config.contentClassName}`, "content");
  slotCase(DProgress, `.${config.contentClassName}`, "default", {
    value: 0,
  });
  offsetCase(wrapper);
  // TODO: props.contentOptions

  propStringCase(wrapper, `.${config.loaderContainerClassName}`, "loader", {
    value: undefined,
  });
  propVNodeCase(wrapper, `.${config.loaderContainerClassName}`, "loader", {
    value: undefined,
  });
  slotCase(DProgress, `.${config.loaderContainerClassName}`, "loader", {
    value: undefined,
  });
  // TODO: props.loaderOptions

  // TODO: props.caption ...
  // TODO: props.captionOffset
  // TODO: props.captionOptions

  // TODO: props.colorScheme
  // TODO: props.rounding
  roundingClassCase(wrapper, `.${config.contentClassName}`, {
    type: Type.circular,
    value: 99,
    content: "Not empty",
  });
  // TODO: props.size
  minControlWidthCase(wrapper, `.${config.linearClassName}`, {
    type: Type.linear,
    value: 99,
  });
  // TODO: props.transition
  // TODO: props.tag

  // TODO: aria attrs
});
